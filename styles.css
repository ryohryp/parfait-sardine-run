  :root { --maxw: 920px; }
  * { box-sizing: border-box; }
  body{margin:0;background:#eaf1f8;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Hiragino Kaku Gothic ProN",Meiryo,sans-serif;color:#222;text-align:center}
  header{padding:12px 8px 4px}
  h1{margin:0 0 6px;font-size:clamp(20px,4vw,28px)}
  #hud{
    font-size:clamp(13px,3.2vw,18px);
    margin:0 auto 12px;
    max-width:var(--maxw);
    display:flex;
    flex-direction:column;
    gap:6px;
    text-align:left;
    background:rgba(255,255,255,.85);
    color:#111827;
    border-radius:12px;
    padding:10px 14px;
    box-shadow:0 6px 22px rgba(15,23,42,.12);
  }
  .hudRow{display:flex;flex-wrap:wrap;gap:8px 16px;align-items:center}
  .hudItem{display:inline-flex;align-items:center;gap:6px;line-height:1.4}
  .hudItem strong{font-size:.78em;letter-spacing:.08em;color:#2563eb;text-transform:uppercase}
  .hudItem .value{font-weight:600}
  .hudTag{display:inline-flex;align-items:center;padding:2px 8px;background:#facc15;color:#111827;border-radius:999px;font-size:.75em;font-weight:600}
  .hudHearts{font-size:1.05em}
  .hudCoins{gap:4px}
  #wrap{max-width:var(--maxw);margin:0 auto;padding:8px}
  canvas{width:100%;height:auto;max-width:var(--maxw);background:linear-gradient(#9ed6ee,#fff7e6);border:2px solid #333;border-radius:12px;touch-action:none}
  #btns{display:flex;gap:8px;justify-content:center;margin:10px 0;flex-wrap:wrap}
  button{appearance:none;border:0;border-radius:10px;padding:10px 16px;font-size:16px;background:#22c55e;color:#fff;box-shadow:0 2px 0 rgba(0,0,0,.2)}
  button.secondary{background:#3b82f6}
  button.ghost{background:#6b7280}
  button.warn{background:#ef4444}
  button:disabled{opacity:.5}
  .leaderboardList{list-style:none;margin:12px 0 0;padding:0;display:grid;gap:8px}
  #leaderboardOverlay .leaderboardList{margin:0;}
  .leaderboardItem{background:#1f2937;border-radius:10px;padding:10px 12px;display:flex;text-align:left;box-shadow:inset 0 0 0 1px rgba(255,255,255,.05)}
  .leaderboardRow{display:flex;align-items:center;gap:10px;width:100%;flex-wrap:wrap;color:#f9fafb;font-size:14px}
  .lbRank{font-weight:700;min-width:48px}
  .lbName{flex:1;font-weight:600;word-break:break-word}
  .lbLevel{min-width:72px;text-align:right;font-variant-numeric:tabular-nums}
  .lbCoins{min-width:98px;text-align:right;font-variant-numeric:tabular-nums}
  .lbScore{min-width:120px;text-align:right;font-variant-numeric:tabular-nums}
  .lbDate{min-width:132px;text-align:right;font-size:12px;opacity:.8;font-variant-numeric:tabular-nums}
  .leaderboardItem.selfEntry{box-shadow:0 0 0 2px rgba(250,204,21,.55)}
  .leaderboardControls{display:flex;justify-content:flex-end;gap:8px;margin-bottom:4px}
  #leaderboardJump{display:none}
  .muted{opacity:.75}
  .controls{max-width:var(--maxw);margin:0 auto;line-height:1.6;text-align:left}
  #objective{
    max-width:var(--maxw);
    margin:0 auto 14px;
    text-align:left;
    background:#111827;
    color:#f9fafb;
    border-radius:16px;
    padding:14px 18px;
    box-shadow:0 14px 28px rgba(15,23,42,.28);
  }
  #objective h2{margin:0 0 6px;font-size:clamp(18px,3.2vw,24px)}
  #objective p{margin:0 0 8px;line-height:1.65}
  #objective ul{margin:0;padding-left:22px;display:grid;gap:4px;font-size:clamp(12px,3.2vw,16px)}
  #objective li::marker{color:#facc15}
  #objective strong{color:#fbbf24}
  #ultBtn{
    position: fixed; right: 14px; bottom: 18px; z-index: 10;
    padding:12px 16px; border-radius:14px; background:#ef4444; color:#fff; font-weight:700;
    box-shadow:0 3px 0 rgba(0,0,0,.25); user-select:none;
  }
  @media(hover:hover){ #ultBtn:hover{ filter:brightness(1.05); } }

  /* ガチャ & コレクション オーバーレイ */
  .overlay{
    position:fixed; inset:0; background:rgba(0,0,0,.6); display:none; z-index:20;
    align-items:center; justify-content:center; padding:16px;
  }
  .cardWrap{
    width:min(94vw,820px); background:#111827; color:#fff; border-radius:16px; padding:16px;
    box-shadow:0 8px 32px rgba(0,0,0,.45); text-align:left;
  }
  .cardHeader{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
  .cardHeader h2{margin:0;font-size:20px}
  .cardBody{min-height:160px;border:1px solid #374151;border-radius:12px;padding:12px;background:#0b1220}
  #leaderboardOverlay .cardBody{
    max-height:min(70vh,520px);
    overflow-y:auto;
    display:flex;
    flex-direction:column;
    gap:12px;
  }
  #leaderboardStatus{margin:0}
  .grid{display:grid;grid-template-columns:repeat(5,1fr);gap:8px}
  .miniCard{
    border-radius:12px; padding:10px; text-align:center; min-height:84px;
    display:flex;flex-direction:column;align-items:center;justify-content:center;
    box-shadow:inset 0 0 0 2px rgba(255,255,255,.08); cursor:pointer;
  }
  .codexList{list-style:none;margin:0;padding:0;display:grid;gap:10px}
  .codexItem{display:flex;gap:10px;align-items:flex-start;background:#0f172a;border-radius:12px;padding:12px 14px;box-shadow:inset 0 0 0 1px rgba(148,163,184,.25)}
  .codexIcon{font-size:28px;line-height:1}
  .codexBody{display:flex;flex-direction:column;gap:4px}
  .codexBody h3{margin:0;font-size:16px}
  .codexBody p{margin:0;font-size:13px;line-height:1.6;opacity:.9}
  .codexMeta{font-size:13px;opacity:.85;display:flex;flex-wrap:wrap;gap:10px}
  .howList{display:grid;gap:8px;margin:12px 0 0;padding-left:20px;line-height:1.6}
  .howList li::marker{color:#3b82f6;font-weight:700}
  .howLead{margin:8px 0 0;line-height:1.6}
  .howFooter{display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;gap:12px;margin-top:16px}
  .howFooterNote{font-size:13px;opacity:.75}
  .rar-c{background:#111827}
  .rar-r{background:linear-gradient(135deg,#1f2937,#0ea5e9)}
  .rar-e{background:linear-gradient(135deg,#3b0764,#a21caf)}
  .rar-l{background:linear-gradient(135deg,#7c2d12,#f59e0b)}
  .rar-m{background:linear-gradient(135deg,#16213e,#22d3ee)}
  .big{font-size:28px}
  .small{font-size:12px;opacity:.85}
  .footerBtns{display:flex;gap:8px;justify-content:flex-end;margin-top:10px}
  .resultBody{display:flex;flex-direction:column;gap:18px}
  .resultSummary{display:grid;gap:8px}
  .resultSummaryRow{display:flex;justify-content:space-between;align-items:center;padding:8px 10px;border-radius:10px;background:rgba(255,255,255,.08);font-size:14px}
  .resultSummaryRow strong{font-size:13px;letter-spacing:.08em;text-transform:uppercase;opacity:.75}
  .resultSummaryRow span{font-variant-numeric:tabular-nums;font-weight:600}
  .resultSection h3{margin:0 0 8px;font-size:16px}
  .resultSection:first-of-type{margin-top:0}
  .resultSection{margin-top:4px}
  .resultList{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:6px}
  .resultList li{display:flex;justify-content:space-between;gap:12px;align-items:flex-start;background:rgba(15,23,42,.55);border-radius:10px;padding:8px 10px;font-size:14px}
  .resultList .label{font-weight:600;display:flex;gap:6px;align-items:center}
  .resultList .value{text-align:right;font-variant-numeric:tabular-nums;display:flex;flex-direction:column;align-items:flex-end;gap:2px}
  .resultList .value small{font-size:12px;color:#facc15}
  .resultList .note{font-size:12px;opacity:.75}
  .resultList li.resultEmpty{justify-content:center;opacity:.6;font-style:italic}

  /* コメント */
  .commentBody{display:flex;flex-direction:column;gap:16px}
  .commentForm{display:grid;gap:12px}
  .commentLabel{display:flex;flex-direction:column;gap:6px;font-size:14px}
  .commentLabel span{font-weight:600;letter-spacing:.04em;text-transform:uppercase;font-size:12px;opacity:.8}
  .commentLabel span small{font-weight:500;letter-spacing:0;text-transform:none;font-size:11px;opacity:.75}
  .commentLabel input,
  .commentLabel textarea{
    width:100%;
    border-radius:10px;
    border:1px solid rgba(255,255,255,.12);
    padding:10px 12px;
    background:rgba(15,23,42,.45);
    color:#f9fafb;
    font:inherit;
    resize:vertical;
    min-height:42px;
  }
  .commentLabel textarea{min-height:96px;line-height:1.6}
  .commentLabel input::placeholder,
  .commentLabel textarea::placeholder{color:rgba(248,250,252,.5)}
  .commentFormActions{display:flex;justify-content:flex-end;gap:8px}
  .commentList{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:10px}
  .commentItem{background:rgba(15,23,42,.65);border-radius:12px;padding:10px 12px;display:flex;flex-direction:column;gap:6px;box-shadow:inset 0 0 0 1px rgba(148,163,184,.15)}
  .commentItemHeader{display:flex;justify-content:space-between;gap:10px;font-size:13px;color:#f3f4f6;opacity:.9}
  .commentItemMeta{display:flex;align-items:center;gap:8px;flex-wrap:wrap;justify-content:flex-end}
  .commentItemName{font-weight:600;word-break:break-word}
  .commentItemDate{font-variant-numeric:tabular-nums;opacity:.75}
  .commentItemMessage{font-size:14px;line-height:1.6;color:#f9fafb;word-break:break-word;white-space:pre-wrap}
  .commentItemEmpty{justify-content:center;align-items:center;opacity:.7;font-style:italic;color:#e5e7eb}
  .commentLikeBtn{
    background:rgba(148,163,184,.18);
    border:1px solid rgba(248,250,252,.18);
    border-radius:999px;
    color:#facc15;
    padding:4px 10px;
    font-size:12px;
    font-weight:600;
    display:inline-flex;
    align-items:center;
    gap:6px;
    cursor:pointer;
    box-shadow:none;
    transition:background .2s,color .2s,transform .15s;
  }
  .commentLikeBtn .commentLikeIcon{font-size:14px;line-height:1}
  .commentLikeBtn.isLiked{
    background:#f97316;
    color:#fff;
    border-color:rgba(249,115,22,.3);
  }
  .commentLikeBtn:disabled{
    opacity:.6;
    cursor:wait;
  }
  @media(hover:hover){
    .commentLikeBtn:hover{transform:translateY(-1px);}
    .commentLikeBtn:disabled:hover{transform:none;}
  }
  .commentFeed{
    max-width:var(--maxw);
    margin:20px auto 24px;
    text-align:left;
    background:#f8fafc;
    color:#0f172a;
    border-radius:18px;
    padding:18px 20px;
    box-shadow:0 16px 32px rgba(15,23,42,.16);
  }
  .commentFeed h2{margin:0 0 10px;font-size:clamp(18px,3vw,24px)}
  .commentFeedStatus{margin:0 0 12px;font-size:14px;color:#475569}
  .commentFeed .commentItem{background:#fff;color:#0f172a;box-shadow:inset 0 0 0 1px rgba(148,163,184,.25)}
  .commentFeed .commentItemHeader{color:#1f2937;opacity:1}
  .commentFeed .commentItemDate{opacity:.8;color:#475569}
  .commentFeed .commentItemMessage{color:#1f2937}
  .commentFeed .commentItemEmpty{color:#94a3b8}
  .commentFeed .commentLikeBtn{
    background:rgba(226,232,240,.75);
    border-color:rgba(148,163,184,.45);
    color:#f97316;
  }
  .commentFeed .commentLikeBtn.isLiked{
    background:#f97316;
    color:#fff;
    border-color:rgba(249,115,22,.45);
  }

  /* 右上インジケーター */
  #charInfo{position:fixed; right:12px; top:8px; font-size:12px; background:rgba(0,0,0,.5); color:#fff; padding:6px 10px; border-radius:10px}
